<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>12장 파드 스케줄링 | 📝 Today Gimun Learned</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/TIL/images/logo-144.png">
    <link rel="manifest" href="/TIL/manifest.json">
    <meta name="description" content="Personal Wiki (Today I Learned)">
    <link rel="preload" href="/TIL/assets/css/0.styles.d478e3a5.css" as="style"><link rel="preload" href="/TIL/assets/js/app.6d51d112.js" as="script"><link rel="preload" href="/TIL/assets/js/2.665be0f4.js" as="script"><link rel="preload" href="/TIL/assets/js/31.7df1dd49.js" as="script"><link rel="preload" href="/TIL/assets/js/9.9b43db21.js" as="script"><link rel="preload" href="/TIL/assets/js/10.0186ca23.js" as="script"><link rel="prefetch" href="/TIL/assets/js/11.02bf2f38.js"><link rel="prefetch" href="/TIL/assets/js/12.676d19bd.js"><link rel="prefetch" href="/TIL/assets/js/13.c6904bf2.js"><link rel="prefetch" href="/TIL/assets/js/14.ff20580a.js"><link rel="prefetch" href="/TIL/assets/js/15.dd747fe6.js"><link rel="prefetch" href="/TIL/assets/js/16.986ee545.js"><link rel="prefetch" href="/TIL/assets/js/17.c592a804.js"><link rel="prefetch" href="/TIL/assets/js/18.c95b0edd.js"><link rel="prefetch" href="/TIL/assets/js/19.a3a8db9b.js"><link rel="prefetch" href="/TIL/assets/js/20.291ec964.js"><link rel="prefetch" href="/TIL/assets/js/21.a4bef1d3.js"><link rel="prefetch" href="/TIL/assets/js/22.4ad3925b.js"><link rel="prefetch" href="/TIL/assets/js/23.6d4bf165.js"><link rel="prefetch" href="/TIL/assets/js/24.28de3946.js"><link rel="prefetch" href="/TIL/assets/js/25.c83e441f.js"><link rel="prefetch" href="/TIL/assets/js/26.61de3f2c.js"><link rel="prefetch" href="/TIL/assets/js/27.15fa532a.js"><link rel="prefetch" href="/TIL/assets/js/28.a185f3fa.js"><link rel="prefetch" href="/TIL/assets/js/29.8d45c731.js"><link rel="prefetch" href="/TIL/assets/js/3.023b1c34.js"><link rel="prefetch" href="/TIL/assets/js/30.f67b9aa0.js"><link rel="prefetch" href="/TIL/assets/js/32.40d59edd.js"><link rel="prefetch" href="/TIL/assets/js/33.5510930b.js"><link rel="prefetch" href="/TIL/assets/js/34.922d61b7.js"><link rel="prefetch" href="/TIL/assets/js/35.f21434a2.js"><link rel="prefetch" href="/TIL/assets/js/36.2a19b6a6.js"><link rel="prefetch" href="/TIL/assets/js/37.85434dd0.js"><link rel="prefetch" href="/TIL/assets/js/38.3178dcc5.js"><link rel="prefetch" href="/TIL/assets/js/39.c4e76c3e.js"><link rel="prefetch" href="/TIL/assets/js/4.b0a67ecb.js"><link rel="prefetch" href="/TIL/assets/js/5.bad944ca.js"><link rel="prefetch" href="/TIL/assets/js/6.0b0888e7.js"><link rel="prefetch" href="/TIL/assets/js/7.a7b2723d.js"><link rel="prefetch" href="/TIL/assets/js/8.c112f2bb.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.d478e3a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">📝 Today Gimun Learned</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/GimunLee/TIL" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/GimunLee/TIL" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🎯 Goals For</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💎 Web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>📖 Kubernetes</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/book-kubernetes/01장 쿠버네티스.html" class="sidebar-link">01장 쿠버네티스</a></li><li><a href="/TIL/book-kubernetes/02장 쿠버네티스 도구.html" class="sidebar-link">02장 쿠버네티스 도구</a></li><li><a href="/TIL/book-kubernetes/03장 쿠버네티스로 컨테이너 실행하기.html" class="sidebar-link">03장 쿠버네티스 컨테이너 실행하기</a></li><li><a href="/TIL/book-kubernetes/04장 쿠버네티스 기본 개념.html" class="sidebar-link">04장 쿠버네티스 기본 개념</a></li><li><a href="/TIL/book-kubernetes/05장 파드.html" class="sidebar-link">05장 파드</a></li><li><a href="/TIL/book-kubernetes/06장 컨트롤러.html" class="sidebar-link">06장 컨트롤러</a></li><li><a href="/TIL/book-kubernetes/07장 서비스.html" class="sidebar-link">07장 서비스</a></li><li><a href="/TIL/book-kubernetes/08장 인그레스.html" class="sidebar-link">08장 인그레스</a></li><li><a href="/TIL/book-kubernetes/09장 레이블과 어노테이션.html" class="sidebar-link">레이블과 애너테이션</a></li><li><a href="/TIL/book-kubernetes/10장 컨피그맵.html" class="sidebar-link">10장 컨피그맵</a></li><li><a href="/TIL/book-kubernetes/11장 시크릿.html" class="sidebar-link">11장 시크릿</a></li><li><a href="/TIL/book-kubernetes/12장 파드 스케줄링.html" class="active sidebar-link">12장 파드 스케줄링</a></li><li><a href="/TIL/book-kubernetes/복사용.html" class="sidebar-link">/book-kubernetes/복사용.html</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📖 Angular Essentials</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📖 Object</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📖 Head First Design Patterns</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📚 ETC</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_12장-파드-스케줄링"><a href="#_12장-파드-스케줄링" class="header-anchor">#</a> 12장 파드 스케줄링</h1> <p id="abg">Assembled by GimunLee</p> <br> <h2 id="파드-스케줄링"><a href="#파드-스케줄링" class="header-anchor">#</a> 파드 스케줄링</h2> <ul><li>특정 파드들을 노드 하나에 모아두거나 특정 IP 대역의 노드들에서만 실행</li> <li>같은 기능이 있는 파드들이 노드 하나에 몰려있지 않도록 분산 실행</li> <li>관리가 필요한 노드가 있을때 해당 노드에 있는 파드들을 다른 노드로 이동</li></ul> <br> <h2 id="노드셀렉터"><a href="#노드셀렉터" class="header-anchor">#</a> 노드셀렉터</h2> <ul><li>가장 간단한 스케줄링 옵션을 <code>.spec</code> 필드에 설정 가능한 노드셀렉터가 있음</li> <li>파드가 클러스터 안 어떤 노드에서 실행될지를 키-값 쌍으로 설정</li> <li>노드셀렉터는 노드의 레이블에 설정된 값으로 노드를 선택</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>nodeselector<span class="token punctuation">-</span>pod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>nodeselector<span class="token punctuation">-</span>pod
    <span class="token key atrule">image</span><span class="token punctuation">:</span> arisu1000/simple<span class="token punctuation">-</span>container<span class="token punctuation">-</span>app<span class="token punctuation">:</span>latest
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">nodeSelector</span><span class="token punctuation">:</span> 
    <span class="token key atrule">disktype</span><span class="token punctuation">:</span> ssd  <span class="token comment"># disktype이 ssd인 노드에 실행 가능</span>
</code></pre></div><br> <h2 id="어피니티와-안티-어피니티"><a href="#어피니티와-안티-어피니티" class="header-anchor">#</a> 어피니티와 안티 어피니티</h2> <ul><li>파드들을 함께 묶어서 같은 노드에서 실행하도록 설정하는 어피니티와 파드들을 다른 노드에 나누어서 실행하도록 설정하는 안티 어피니티</li></ul> <h3 id="노드-어피니티-node-affinity"><a href="#노드-어피니티-node-affinity" class="header-anchor">#</a> 노드 어피니티(Node affinity)</h3> <ul><li>노드 어피니티는 노드셀렉터와 비슷하게 노드의 레이블 기반으로 파드를 스케줄링</li> <li>노드 어피니티와 노드셀렉터를 함께 설정할 수 있으며 이때는 노드 어피니티와 노드셀렉터의 조건을 모두. 만족하는 노드에 파드를 스케줄링</li> <li><code>requiredDuringSchedulingIgnoredDuringExecution</code>,<code>preferredDuringSchedulingIgnoredDuringExecution</code> 두 필드는 실행 중에 조건이 바뀌어도 무시; 파드가 이미 스케줄링되어 특정 노드에서 실행 중이라면 중간에 해당 노드의 조건이 변경되더라도 이미 실행 중인 파드는 그대로 실행된다는 뜻</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>nodeaffinity<span class="token punctuation">-</span>pod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>nodeaffinity<span class="token punctuation">-</span>pod
    <span class="token key atrule">image</span><span class="token punctuation">:</span> arisu1000/simple<span class="token punctuation">-</span>container<span class="token punctuation">-</span>app<span class="token punctuation">:</span>latest
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">affinity</span><span class="token punctuation">:</span> <span class="token comment"># 어피니티 설정</span>
    <span class="token key atrule">nodeAffinity</span><span class="token punctuation">:</span> <span class="token comment"># 노드 어피니티</span>
      <span class="token key atrule">requiredDuringSchedulingIgnoredDuringExecution</span><span class="token punctuation">:</span> <span class="token comment"># 스케줄링하는 동안 꼭 필요한 조건</span>
        <span class="token key atrule">nodeSelectorTerms</span><span class="token punctuation">:</span> <span class="token comment"># 노드 어피니티 유형</span>
        <span class="token punctuation">-</span> <span class="token key atrule">matchExpressions</span><span class="token punctuation">:</span> <span class="token comment"># 연관된 노드셀렉터 설정을 연결하는 필드</span>
          <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> beta.kubernetes.io/os <span class="token comment"># 노드의 레이블 키 중 하나를 설정</span>
            <span class="token key atrule">operator</span><span class="token punctuation">:</span> In <span class="token comment"># 키가 만족할 조건 </span>
	            <span class="token comment"># In: .values[] 필드에 설정한 값 중 레입ㄹ에 있는 값과 일치하는 것이 하나라도 있는지 확인</span>
	            <span class="token comment"># NotIn: In과 반대로 .values[] 필드에 있는 값 모두와 맞지 않는지 확인</span>
	            <span class="token comment"># Exists: .values[] 필드가 필요 없고 .key 필드에 설정한 값이 레이블에 있는지만 확인</span>
	            <span class="token comment"># DoesNotExist: Exists와 반대</span>
	            <span class="token comment"># Gt: Greater than으로 .values[] 필드에 설정된 값보다 큰 숫자형 데이터인지를 확인. values에 값이 하나만 있어야함</span>
	            <span class="token comment"># Lt: Lower than으로 Gt와 반대</span>
            <span class="token key atrule">values</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> linux
            <span class="token punctuation">-</span> window
          <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> disktype
            <span class="token key atrule">operator</span><span class="token punctuation">:</span> Exists
          <span class="token comment"># - key: core</span>
            <span class="token comment"># operator: Gt</span>
            <span class="token comment"># values:</span>
            <span class="token comment"># - &quot;4&quot;</span>
      <span class="token key atrule">preferredDuringSchedulingIgnoredDuringExecution</span><span class="token punctuation">:</span> <span class="token comment"># 필수는 아니지만 스케줄링하는 동안 만족하면 좋은 조건</span>
      <span class="token punctuation">-</span> <span class="token key atrule">weight</span><span class="token punctuation">:</span> <span class="token number">10</span> <span class="token comment"># 1부터 100까지의 값 설정 가능; 노드의 설정이 맞을 때 마다 .weight 필드 값을 더하고, .weight 합산이 가장 큰 노드를 선택</span>
        <span class="token key atrule">preference</span><span class="token punctuation">:</span> <span class="token comment"># 해당 조건에 맞는 걸 선호</span>
          <span class="token key atrule">matchExpressions</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> kubernetes.io/hostname
            <span class="token key atrule">operator</span><span class="token punctuation">:</span> In
            <span class="token key atrule">values</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> worker<span class="token punctuation">-</span>node01
</code></pre></div><h3 id="파드의-어피니티와-안티-어피니티"><a href="#파드의-어피니티와-안티-어피니티" class="header-anchor">#</a> 파드의 어피니티와 안티 어피니티</h3> <ul><li>파드 사이의 어피니티와 안티 어피니티는 디플로이먼트나 스테이트풀세트로 파드를 배포했을 때 개별 파드 사이의 관계를 정의하는 용도로 사용</li></ul> <h4 id="어피니티"><a href="#어피니티" class="header-anchor">#</a> 어피니티</h4> <ul><li>컨테이너로 서비스를 운영하다 보면 서비스 A의 파드와 서비스 B의 파드 사이에 자주 통신할 때가 있는데, 이때 이 두 파드를 같은 노드에 속하게 만들어 효율을 높임</li> <li>가장 흔한 예로 데이터베이스나 캐시 같은 서비스와 통신하는 앱 컨테이너를 같은 노드에 두어 네트워크 통신 비용을 줄이는 것</li></ul> <h4 id="안티-어피니티"><a href="#안티-어피니티" class="header-anchor">#</a> 안티 어피니티</h4> <ul><li>CPU나 네트워크 같은 하드웨어 자원을 많이 사용하는 앱 컨테이너가 있을 때 여러 노드로 파드를 분산하는 것</li> <li>안티 어피니티를 설정하지 않으면 디플로이먼트로 배포한 파드가 노드 하나에서만 실행되어 자원을 많이 소모할 수 있음</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>cache
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> store
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> store
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">affinity</span><span class="token punctuation">:</span> 
        <span class="token key atrule">podAntiAffinity</span><span class="token punctuation">:</span>
          <span class="token key atrule">requiredDuringSchedulingIgnoredDuringExecution</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">labelSelector</span><span class="token punctuation">:</span>
              <span class="token key atrule">matchExpressions</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> app
                <span class="token key atrule">operator</span><span class="token punctuation">:</span> In
                <span class="token key atrule">values</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span> store <span class="token comment"># app 필드 값이 store인 파드가 속한 노드를 피해서 파드를 추가한다는 설정 	</span>
            <span class="token key atrule">topologyKey</span><span class="token punctuation">:</span> <span class="token string">&quot;kubernetes.io/hostname&quot;</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>server
        <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>3.2<span class="token punctuation">-</span>alpine
</code></pre></div><br> <h2 id="테인트와-톨러레이션"><a href="#테인트와-톨러레이션" class="header-anchor">#</a> 테인트와 톨러레이션</h2> <ul><li>쿠버네티스 클러스터의 특정 노드에 테인트를 설정할 수 있는데, 테인트를 설정하면 설정한 노드에는 파드들을 스케줄링하지 않음</li> <li>테인트를 설정한 노드에 파드들을 스케줄링하기 위해서는 톨러레이션을 설정해야함</li> <li>테인트는 톨러레이션에서 설정한 특정 파드들만 실행하고 다른 파드는 실행하지 못하게 함</li> <li><strong>테인트와 톨러레이션은 주로 노드를 특정 역할만 하도록 만들 때 사용</strong></li> <li>예를 들어 데이터베이스용 파드를 실행한 후 노드 전체의 CPU나 RAM 자원을 독점해서 사용할 수 있도록 설정하는 것</li> <li>테인트는 키, 값, 효과의 세 가지로 구성됨. <code>kubectl taint nodes {노드이름} {키=값:효과}</code></li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>simple<span class="token punctuation">-</span>app
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>simple<span class="token punctuation">-</span>app
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>simple<span class="token punctuation">-</span>app
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>simple<span class="token punctuation">-</span>app
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>simple<span class="token punctuation">-</span>app
        <span class="token key atrule">image</span><span class="token punctuation">:</span> arisu1000/simple<span class="token punctuation">-</span>container<span class="token punctuation">-</span>app<span class="token punctuation">:</span>latest
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
      <span class="token key atrule">tolerations</span><span class="token punctuation">:</span> <span class="token comment"># 테인트가 설정된 노드에 실행시키기 위한 톨러레이션 설정</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> <span class="token string">&quot;key01&quot;</span>
        <span class="token key atrule">operator</span><span class="token punctuation">:</span> <span class="token string">&quot;Equal&quot;</span>
        <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;value01&quot;</span>
        <span class="token key atrule">effect</span><span class="token punctuation">:</span> <span class="token string">&quot;NoSchedule&quot;</span>
        	<span class="token comment"># NoSchedule: 톨러레이션 설정이 없으면 파드를 스케줄링하지 않음. 기존에 실행되던 파드에는 적용되지 않음</span>
        	<span class="token comment"># PreferNoSchedule: 톨러레이션 설정이 없으면 파드를 스케줄링하지 않음. 하지만 자원이 부족하면 스케줄링 가능</span>
        	<span class="token comment"># NoExecute: 톨러레이션 설정이 없으면 새로운 파드를 스케줄링하지 않음. 기존 파드도 테인트 설정을 무시할수 있는 톨러레이션 설정이 없으면 종료 </span>
</code></pre></div><br> <h2 id="클러스터를-관리하는-커든과-드레인"><a href="#클러스터를-관리하는-커든과-드레인" class="header-anchor">#</a> 클러스터를 관리하는 커든과 드레인</h2> <ul><li><p>쿠버네티스를 사용하다 보면 특정 노드에 있는 파드들을 모두 다른 노드로 옮기거나 특정 노드에 파드들을 스케줄링하지 않도록 제한할 필요 존재</p></li> <li><p><strong>커든(cordon):</strong> 지정된 노드에 추가로 파드를 스케줄링해서 실행하지 않도록 함</p></li> <li><p><strong>드레인(drain)</strong></p> <ul><li>노드 관리 등의 이유로 지정된 노드에 있는 파드들을 다른 노드로 이동시키는 명령</li> <li>노드에 데몬세트로 실행한 파드들이 있으면 데몬세트로 실행한 파드들은 삭제해도 데몬세트가 즉시 재실행시키기 때문에 드레인 설정을 적용할 수 없음</li></ul></li></ul> <br> <h2 id="referenses"><a href="#referenses" class="header-anchor">#</a> Referenses</h2> <ul><li>쿠버네티스 입문 - 90가지 예제로 배우는 컨테이너 관리 자동화 표준 / 동양북스</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/19/2020, 11:01:49 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/book-kubernetes/11장 시크릿.html" class="prev">
        11장 시크릿
      </a></span> <span class="next"><a href="/TIL/book-kubernetes/복사용.html">
        /book-kubernetes/복사용.html
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/TIL/assets/js/app.6d51d112.js" defer></script><script src="/TIL/assets/js/2.665be0f4.js" defer></script><script src="/TIL/assets/js/31.7df1dd49.js" defer></script><script src="/TIL/assets/js/9.9b43db21.js" defer></script><script src="/TIL/assets/js/10.0186ca23.js" defer></script>
  </body>
</html>
