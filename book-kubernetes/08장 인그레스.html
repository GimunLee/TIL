<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>08장 인그레스 | 📝 Today Gimun Learned</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/TIL/images/logo-144.png">
    <link rel="manifest" href="/TIL/manifest.json">
    <meta name="description" content="Personal Wiki (Today I Learned)">
    <link rel="preload" href="/TIL/assets/css/0.styles.d478e3a5.css" as="style"><link rel="preload" href="/TIL/assets/js/app.43b6f0d7.js" as="script"><link rel="preload" href="/TIL/assets/js/2.665be0f4.js" as="script"><link rel="preload" href="/TIL/assets/js/27.15fa532a.js" as="script"><link rel="preload" href="/TIL/assets/js/9.5460ba57.js" as="script"><link rel="preload" href="/TIL/assets/js/10.0186ca23.js" as="script"><link rel="prefetch" href="/TIL/assets/js/11.f02ce37d.js"><link rel="prefetch" href="/TIL/assets/js/12.676d19bd.js"><link rel="prefetch" href="/TIL/assets/js/13.c6904bf2.js"><link rel="prefetch" href="/TIL/assets/js/14.447adfa9.js"><link rel="prefetch" href="/TIL/assets/js/15.7ac03229.js"><link rel="prefetch" href="/TIL/assets/js/16.986ee545.js"><link rel="prefetch" href="/TIL/assets/js/17.c592a804.js"><link rel="prefetch" href="/TIL/assets/js/18.c95b0edd.js"><link rel="prefetch" href="/TIL/assets/js/19.a3a8db9b.js"><link rel="prefetch" href="/TIL/assets/js/20.291ec964.js"><link rel="prefetch" href="/TIL/assets/js/21.a4bef1d3.js"><link rel="prefetch" href="/TIL/assets/js/22.4ad3925b.js"><link rel="prefetch" href="/TIL/assets/js/23.6d4bf165.js"><link rel="prefetch" href="/TIL/assets/js/24.28de3946.js"><link rel="prefetch" href="/TIL/assets/js/25.e1890c0f.js"><link rel="prefetch" href="/TIL/assets/js/26.369c5639.js"><link rel="prefetch" href="/TIL/assets/js/28.a185f3fa.js"><link rel="prefetch" href="/TIL/assets/js/29.8d45c731.js"><link rel="prefetch" href="/TIL/assets/js/3.023b1c34.js"><link rel="prefetch" href="/TIL/assets/js/30.f67b9aa0.js"><link rel="prefetch" href="/TIL/assets/js/31.26f9e082.js"><link rel="prefetch" href="/TIL/assets/js/32.fe0055e1.js"><link rel="prefetch" href="/TIL/assets/js/33.822f99c7.js"><link rel="prefetch" href="/TIL/assets/js/34.757196c0.js"><link rel="prefetch" href="/TIL/assets/js/35.414d1489.js"><link rel="prefetch" href="/TIL/assets/js/36.251b5f66.js"><link rel="prefetch" href="/TIL/assets/js/37.17e500ec.js"><link rel="prefetch" href="/TIL/assets/js/38.68350cc7.js"><link rel="prefetch" href="/TIL/assets/js/4.b0a67ecb.js"><link rel="prefetch" href="/TIL/assets/js/5.bad944ca.js"><link rel="prefetch" href="/TIL/assets/js/6.0b0888e7.js"><link rel="prefetch" href="/TIL/assets/js/7.7400ba8a.js"><link rel="prefetch" href="/TIL/assets/js/8.62e92e2f.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.d478e3a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">📝 Today Gimun Learned</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/GimunLee/TIL" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/GimunLee/TIL" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🎯 Goals For</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💎 Web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>📖 Kubernetes</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/book-kubernetes/01장 쿠버네티스.html" class="sidebar-link">01장 쿠버네티스</a></li><li><a href="/TIL/book-kubernetes/02장 쿠버네티스 도구.html" class="sidebar-link">02장 쿠버네티스 도구</a></li><li><a href="/TIL/book-kubernetes/03장 쿠버네티스로 컨테이너 실행하기.html" class="sidebar-link">03장 쿠버네티스 컨테이너 실행하기</a></li><li><a href="/TIL/book-kubernetes/04장 쿠버네티스 기본 개념.html" class="sidebar-link">04장 쿠버네티스 기본 개념</a></li><li><a href="/TIL/book-kubernetes/05장 파드.html" class="sidebar-link">05장 파드</a></li><li><a href="/TIL/book-kubernetes/06장 컨트롤러.html" class="sidebar-link">06장 컨트롤러</a></li><li><a href="/TIL/book-kubernetes/07장 서비스.html" class="sidebar-link">07장 서비스</a></li><li><a href="/TIL/book-kubernetes/08장 인그레스.html" class="active sidebar-link">08장 인그레스</a></li><li><a href="/TIL/book-kubernetes/09장 레이블과 어노테이션.html" class="sidebar-link">레이블과 애너테이션</a></li><li><a href="/TIL/book-kubernetes/10장 컨피그맵.html" class="sidebar-link">10장 컨피그맵</a></li><li><a href="/TIL/book-kubernetes/11장 시크릿.html" class="sidebar-link">11장 시크릿</a></li><li><a href="/TIL/book-kubernetes/복사용.html" class="sidebar-link">/book-kubernetes/복사용.html</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📖 Angular Essentials</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📖 Object</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📖 Head First Design Patterns</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📚 ETC</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_08장-인그레스"><a href="#_08장-인그레스" class="header-anchor">#</a> 08장 인그레스</h1> <p id="abg">Assembled by GimunLee</p> <br> <h2 id="인그레스-개념"><a href="#인그레스-개념" class="header-anchor">#</a> 인그레스 개념</h2> <ul><li>인그레스는 클러스터 외부에서 안으로 접근하는 요청들을 어떻게 처리할지 정의해둔 규칙 모음</li> <li>클러스터 외부에서 접근해야 할 URL을 사용할 수 있도록 하고, 트래픽 로드밸런싱, SSL 인증서 처리, 도메인 기반 가상 호스팅 제공</li> <li>인그레스 자체는 이런 규칙들을 정의해둔 자원이고, 실제로 동작시키는 것은 인그레스 컨트롤러</li> <li>ingress-nginx는 인그레스 컨트롤러와 인그레스를 연동하는 도구</li> <li>ingress-nginx 컨트롤러는 인그레스에서 설정한 내용을 nginx 환경 설정으로 변경해서 nginx에 적용</li></ul> <h3 id="인그레스-설정"><a href="#인그레스-설정" class="header-anchor">#</a> 인그레스 설정</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span> <span class="token comment"># 인그레스 설정할 때 하위 필드 사용</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/rewrite-target</span><span class="token punctuation">:</span> / <span class="token comment"># / 경로로 리다이렉트</span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span> <span class="token comment"># 하위 필드에 어떤 규칙을 사용할지 지정</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> foo.bar.com <span class="token comment"># 이 주소로 요청이 들어오면</span>
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /foos1 <span class="token comment"># 해당 path로 접근하면 </span>
        <span class="token key atrule">backend</span><span class="token punctuation">:</span> <span class="token comment"># 해당 서비스로 전송</span>
          <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> s1
          <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /bars2
        <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> s2
          <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">80</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> bar.foo.com
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> s2
          <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><br> <h2 id="ingress-nginx-컨트롤러"><a href="#ingress-nginx-컨트롤러" class="header-anchor">#</a> ingress-nginx 컨트롤러</h2> <ul><li>인그레스는 설정일 뿐이고 설정 내용대로 동작하는 실제 주체는 인그레스 컨트롤러</li> <li>쿠버네티스가 공식적으로 제공하는 것은 구글 컴퓨트 엔진용 ingress-gce와 nginx용 ingress-nginx</li></ul> <br> <h2 id="인그레스-ssl-설정하기"><a href="#인그레스-ssl-설정하기" class="header-anchor">#</a> 인그레스 SSL 설정하기</h2> <ul><li>인그레스를 이용하면 요청으로 들어오는 트래픽에 다양한 설정을 할 수 있음</li> <li>인그레스로 SSL 인증서를 설정하면 파드 각각에 SSL 설정을 따로 할 필요가 없어 편리함</li> <li>SSL 인증서 기한이 만료됐을 때도 인그레스에서만 인증서를 업데이트하면 됨</li></ul> <h3 id="ssl-인증서-설정"><a href="#ssl-인증서-설정" class="header-anchor">#</a> SSL 인증서 설정</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>$ kubectl create secret tls kube-book-secret --key tls.key --cert tls.crt
</code></pre></div><h3 id="시크릿을-인그레스에-적용하는-설정"><a href="#시크릿을-인그레스에-적용하는-설정" class="header-anchor">#</a> 시크릿을 인그레스에 적용하는 설정</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> ingress<span class="token punctuation">-</span>ssl
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">tls</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> kube<span class="token punctuation">-</span>book.com <span class="token comment"># 호스트 네임</span>
    <span class="token key atrule">secretName</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>book<span class="token punctuation">-</span>secret <span class="token comment"># 만든 시크릿 이름 </span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>book.com
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
        <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> s1
          <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><br> <h2 id="무중단-배포를-할-때-주의할-점"><a href="#무중단-배포를-할-때-주의할-점" class="header-anchor">#</a> 무중단 배포를 할 때 주의할 점</h2> <ul><li>새로운 파드(v2)가 생성되고 헬스 체크가 성공한 후 트래픽을 파드(v2) 쪽으로 전송</li> <li>그후 파드(v1) 쪽으로 보내던 트래픽을 중단한 후 파드(v1)을 제거</li></ul> <h3 id="maxsurge와-maxunavailable-필드-설정"><a href="#maxsurge와-maxunavailable-필드-설정" class="header-anchor">#</a> maxSurge와 maxUnavailable 필드 설정</h3> <ul><li>파드 관리를 RollingUpdate로 설정했을 때 .maxSurge와 .maxUnavailable 필드 설정이 필요</li> <li>디플로이먼트를 이용해서 컨테이너를 배포할 때 .maxSurge 필드에는 디플로이먼트에 설정된 기본 파드 개수에 여분의 파드를 몇개 추가할 수 있는지 설정 가능</li> <li>.maxUnavailalbe 필드에는 디플로이먼트를 업데이트하는 동안 몇 개의 파드를 이용할 수 없어도 되는지 설정</li></ul> <h3 id="파드가-readinessprobe를-지원하는지-확인"><a href="#파드가-readinessprobe를-지원하는지-확인" class="header-anchor">#</a> 파드가 readinessProbe를 지원하는지 확인</h3> <ul><li>무중단 배포에서 신경 써서 봐야할 프로브는 readinessProbe</li> <li>readinessProbe는 실제로 컨테이너가 서비스 요청을 처리할 준비가 되었는지 진단</li> <li>readinessProbe가 OK 상태여야 해당 파드와 연결된 서비스에 파드의 IP가 추가되고 트래픽을 받을 수 있음</li> <li>컨테이너 자체에 readinessProbe를 설정하기 어려운 상황이라면 .spec.minReadySeconds 필드를 이용해 어느 정도 readinessProbe와 비슷한 효과를 낼 수 있음</li></ul> <h3 id="쿠버네티스와-컨테이너-안에-그레이스풀-종료-설정"><a href="#쿠버네티스와-컨테이너-안에-그레이스풀-종료-설정" class="header-anchor">#</a> 쿠버네티스와 컨테이너 안에 그레이스풀 종료 설정</h3> <ul><li>노드 안 컨테이너를 관리하는 컴포넌트인 kubelet은 새 파드가 실행되고 이전 파드를 종료할 때 파드에 SIGTERM 신호를 먼저 전송</li> <li>무중단 배포를 하려면 컨테이너에서 SIGTERM 신호를 받았을 때 기존에 받은 요청만 처리를 완료하고 새 요청을 받지 않는 그레이스풀 종료가 설정되어 있어야함</li> <li>kubelet에서 파드에 SGTERM 신호를 보낸 후 일정 시간동안 그레이스풀 종료가 되지 않으면 강제로 SIGKILL 신호를 보내서 파드를 종료</li> <li>대기 시간은 .terminationGracePeriodSeconds 필드로 설정 가능(기본 대기 시간은 30초)</li> <li>그레이스풀 종료를 설정하지 못할 때, 프리스톱 훅(prestop hook)을 이용할 수 있음</li> <li>쿠버네티스에서는 파드 생명 주기 중 훅을 설정할 수 있는데, <strong>파드가 실행된 직후 실행하는 포스트스타트 훅과 파드가 종료되기 직전 실행되는 프리스톱 훅</strong></li> <li>하지만 이렇게 프리스톱 훅으로 대기 시간을 설정하더라도 .terminationGracePeriodSeconds 필드에 설정한 대기 시간을 초과한다면 프로세스 종료 발생 가능</li></ul> <br> <h2 id="무중단-배포-테스트"><a href="#무중단-배포-테스트" class="header-anchor">#</a> 무중단 배포 테스트</h2> <h3 id="deployment-yaml"><a href="#deployment-yaml" class="header-anchor">#</a> deployment.yaml</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> websample
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">run</span><span class="token punctuation">:</span> websample
  <span class="token key atrule">strategy</span><span class="token punctuation">:</span>
    <span class="token key atrule">rollingUpdate</span><span class="token punctuation">:</span> 
      <span class="token key atrule">maxSurge</span><span class="token punctuation">:</span> 25% <span class="token comment"># 기본 파드 개수의 25%만큼 파드를 더 추가할 수 있음</span>
      <span class="token key atrule">maxUnavailable</span><span class="token punctuation">:</span> 25% <span class="token comment"># 디플로이먼트를 업데이트하는 동안 기본 파드 개수의 25%만큼의 파드를 이용할 수 없음</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> RollingUpdate
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">run</span><span class="token punctuation">:</span> websample
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> acadx0/190713<span class="token punctuation">:</span>v1
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> Always
        <span class="token key atrule">name</span><span class="token punctuation">:</span> websample
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">5000</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
        <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span> 
          <span class="token key atrule">httpGet</span><span class="token punctuation">:</span> <span class="token comment"># HTTPGetAction 핸들러를 사용해 컨테이너 진단</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span> /liveness
            <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5000</span>
        <span class="token key atrule">readinessProbe</span><span class="token punctuation">:</span>
          <span class="token key atrule">httpGet</span><span class="token punctuation">:</span> <span class="token comment"># HTTPGetAction 핸들러를 사용해 컨테이너 진단</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span> /readiness
            <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5000</span>
        <span class="token key atrule">lifecycle</span><span class="token punctuation">:</span>
          <span class="token key atrule">preStop</span><span class="token punctuation">:</span>
            <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
              <span class="token key atrule">path</span><span class="token punctuation">:</span> /prestop
              <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5000</span>
      <span class="token key atrule">terminationGracePeriodSeconds</span><span class="token punctuation">:</span> <span class="token number">30</span>
</code></pre></div><h3 id="ingress-yaml"><a href="#ingress-yaml" class="header-anchor">#</a> ingress.yaml</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> websample<span class="token punctuation">-</span>ing
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//127.0.0.1.xip.io
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> websample
          <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">5000</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> /
</code></pre></div><ul><li>지속적 요청을 보내며 배포 테스트를 진행할 수 있는 베게타라는 부하 테스트 도구 이용해 진행</li> <li>실시간 모니터링 도구 스턴(stern)의 <code>stern websample</code> 명령으로 로그를 확인해보면 애플리케이션 측명에서의 무중단 배포 과정을 좀 더 쉽게 확인 가능</li></ul> <br> <h2 id="referenses"><a href="#referenses" class="header-anchor">#</a> Referenses</h2> <ul><li>쿠버네티스 입문 - 90가지 예제로 배우는 컨테이너 관리 자동화 표준 / 동양북스</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/12/2020, 11:05:02 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/book-kubernetes/07장 서비스.html" class="prev">
        07장 서비스
      </a></span> <span class="next"><a href="/TIL/book-kubernetes/09장 레이블과 어노테이션.html">
        레이블과 애너테이션
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/TIL/assets/js/app.43b6f0d7.js" defer></script><script src="/TIL/assets/js/2.665be0f4.js" defer></script><script src="/TIL/assets/js/27.15fa532a.js" defer></script><script src="/TIL/assets/js/9.5460ba57.js" defer></script><script src="/TIL/assets/js/10.0186ca23.js" defer></script>
  </body>
</html>
