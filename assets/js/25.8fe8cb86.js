(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{417:function(t,a,s){"use strict";s.r(a);var e=s(27),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_06장-컨트롤러"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_06장-컨트롤러"}},[t._v("#")]),t._v(" 06장 컨트롤러")]),t._v(" "),s("ABG"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"컨트롤러"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#컨트롤러"}},[t._v("#")]),t._v(" 컨트롤러")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("컨트롤러란 파드들을 관리하는 역할")])])]),t._v(" "),s("li",[s("p",[t._v("웹 서비스처럼 오랜 시간동안 계속 실행되어야 하는 파드들을 관리할 때는 "),s("strong",[t._v("레플리케이션 컨트롤러, 레플리카 세트, 디플로이먼트")])])]),t._v(" "),s("li",[s("p",[t._v("클러스터의 전체 노드에 같은 파드를 실행할 때는 "),s("strong",[t._v("데몬 세트")])])]),t._v(" "),s("li",[s("p",[t._v("상태가 없는 앱을 실행하는데 사용하는 컨테이너를 상태가 있는 앱을 실행할 때 사용하도록 만드는 "),s("strong",[t._v("스테이트풀세트")])])]),t._v(" "),s("li",[s("p",[t._v("1회성 작접을 할 때 사용하는 "),s("strong",[t._v("잡")]),t._v(" , 주기적인 배치 작업을 실행할 때 사용하는 "),s("strong",[t._v("크론잡")])])]),t._v(" "),s("li",[s("p",[t._v("이처럼 다양한 목적에 맞게 사용할 수 있는 컨트롤러가 있다는 것이 쿠버네티스의 큰 장점")])])]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"레플리케이션-컨트롤러-replication-controller"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#레플리케이션-컨트롤러-replication-controller"}},[t._v("#")]),t._v(" 레플리케이션 컨트롤러(Replication Controller)")]),t._v(" "),s("ul",[s("li",[t._v("쿠버네티스 프로젝트의 초기부터 있었던 가장 기본적인 컨트롤러")]),t._v(" "),s("li",[t._v("지정한 숫자만큼의 파드가 항상 클러스터 안에서 실행되도록 관리")]),t._v(" "),s("li",[t._v("요즘에는 비슷한 역할을 하는 "),s("strong",[t._v("레플리카세트를")]),t._v(" 사용")])]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"레플리카세트-replicaset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#레플리카세트-replicaset"}},[t._v("#")]),t._v(" 레플리카세트(Replicaset)")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("레플리카세트는 레플레케이션 컨트롤러의 발전형으로, 레플리케이션 컨트롤러와 같은 동작을 하지만, 집합 기반의 셀렉터(in, notin, exists)를 지원하는 차이점 존재")])]),t._v(" "),s("li",[s("p",[t._v("레플리케이션 컨트롤러는 kubectl에서 rolling-update 옵션을 사용할 수 있지만 레플리카세트는 사용할 수 없다는 차이 존재")])]),t._v(" "),s("li",[s("p",[t._v("레플리카세트를 사용하는데 rolling-update 옵션이 필요할 때는 디플로이먼트 사용")])])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" apps/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ReplicaSet\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("replicaset\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("replicaset\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("replicaset "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# selector에서 쓰일 이름")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("replicaset\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replicas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 유지할 파드의 개수")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchLabels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("replicaset "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 어떤 레이블의 파드를 선택해서 관리할지 설정")]),t._v("\n")])])]),s("h3",{attrs:{id:"레플리카세트와-파드의-연관-관계"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#레플리카세트와-파드의-연관-관계"}},[t._v("#")]),t._v(" 레플리카세트와 파드의 연관 관계")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("파드는 레이블 기준으로 관리하므로 레플리카세트와 파드는 느슨하게 결합되어 있어, 수정, 삭제, 생성에 용이함")])]),t._v(" "),s("li",[s("p",[t._v("레플리카세트 삭제를 파드에 영향을 안 주고 삭제시킬 수 있음")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl delete replicaset nginx-replicaset --cascade"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false\n")])])])])]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"디플로이먼트-deployment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#디플로이먼트-deployment"}},[t._v("#")]),t._v(" 디플로이먼트(Deployment)")]),t._v(" "),s("ul",[s("li",[t._v("쿠버네티스에서 상태가 없는 앱을 배포할 때 사용하는 가장 기본적인 컨트롤러")]),t._v(" "),s("li",[t._v("디플로이먼트는 레플리카세트를 관리하면서 앱 배포를 더 세밀하게 관리")]),t._v(" "),s("li",[t._v("단순히 실행시켜야 할 파드 개수를 유지하는 것뿐 아니라 앱을 배포할 때 롤링 업데이트하거나, 앱 배포 도중 잠시 멈췄다 다시 배포할 수 있음")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" apps/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deployment\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deployment\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deployment\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replicas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 실행할 파드의 수 설정")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchLabels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deployment "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# metadata.labels.app 과 같은 값을 설정 ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deployment\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deployment "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 실제 사용하려는 컨테이너 이름")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 컨테이너 이미지")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 포트")]),t._v("\n")])])]),s("h4",{attrs:{id:"디플로이먼트-수정"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#디플로이먼트-수정"}},[t._v("#")]),t._v(" 디플로이먼트 수정")]),t._v(" "),s("ul",[s("li",[t._v("디플로이먼트 설정을 변경할 때마다 새로운 레플리카세트가 생성되고 그에 맞게 파드가 변경됨")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" image deployment/nginx-deployment nginx-deployment"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx:1.191\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl edit deploy nginx-deployment\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 편집기 시작")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 편집기 종료 후")]),t._v("\ndeployment.extentions/nginx-deployment edited\n")])])]),s("h4",{attrs:{id:"디플로이먼트-롤백하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#디플로이먼트-롤백하기"}},[t._v("#")]),t._v(" 디플로이먼트 롤백하기")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 정보 확인")]),t._v("\n$ kubectl rollout "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("history")]),t._v(" deploy nginx-deployment\t\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 상세 내용 확인")]),t._v("\n$ kubectl rollout "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("history")]),t._v(" deploy nginx-deployment --revision"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 현재 리비전을 되돌림")]),t._v("\n$ kubcetl rollout undo deploy nginx-deployment\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 특정 리비전(3)으로 실행 중인 파드 되돌리기")]),t._v("\n$ kubectl rollout undo deploy nginx-deployment --to-revision"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n")])])]),s("ul",[s("li",[t._v("되돌릴 수 있는 리비전 숫자는 디플로이먼트의 템플릿의 "),s("code",[t._v(".spec.revisionHistoryLimit")]),t._v(" 필드 값(default: 10)")])]),t._v(" "),s("h4",{attrs:{id:"파드-개수-조정하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#파드-개수-조정하기"}},[t._v("#")]),t._v(" 파드 개수 조정하기")]),t._v(" "),s("ul",[s("li",[t._v("실행 중인 디플로이먼트의 파드 개수를 조정하려면 "),s("code",[t._v("kubectl scale")]),t._v(" 명령 실행")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl scale deploy nginx-deployment --replicas"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n")])])]),s("h3",{attrs:{id:"디플로이먼트-배포-정리-배포-재개-재시작하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#디플로이먼트-배포-정리-배포-재개-재시작하기"}},[t._v("#")]),t._v(" 디플로이먼트 배포 정리, 배포 재개, 재시작하기")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("kubectl rollout")]),t._v(" 명령을 이용해서 진행 중인 배포를 잠시 멈췄다가 다시 시작할 수 있음")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 업데이트 멈추기")]),t._v("\n$ kubectl rollout pause deploy/nginx-deployment\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 재개")]),t._v("\n$ kubectl rollout resume deploy/nginx-deployment\n")])])]),s("h3",{attrs:{id:"디플로이먼트-상태"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#디플로이먼트-상태"}},[t._v("#")]),t._v(" 디플로이먼트 상태")]),t._v(" "),s("ul",[s("li",[t._v("배포 중에는 디플로이먼트 상태가 변함")])]),t._v(" "),s("h4",{attrs:{id:"진행-progressing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#진행-progressing"}},[t._v("#")]),t._v(" 진행(Progressing)")]),t._v(" "),s("ul",[s("li",[t._v("디플로이먼트가 새로운 레플리카세트를 만들 때")]),t._v(" "),s("li",[t._v("디플로이먼트가 새로운 레플리카세트의 파드 개수를 늘릴 때")]),t._v(" "),s("li",[t._v("디플로이먼트가 예전 레플리카세트의 파드 개수를 줄일 때")]),t._v(" "),s("li",[t._v("새로운 파드가 준비 상태가 되거나 이용 가능한 상태가 되었을 때")])]),t._v(" "),s("h4",{attrs:{id:"완료-complete"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#완료-complete"}},[t._v("#")]),t._v(" 완료(Complete)")]),t._v(" "),s("ul",[s("li",[t._v("디플로이먼트가 관리하는 모든 레플리카세트가 업데이 완료되었을 때")]),t._v(" "),s("li",[t._v("모든 레플리카세트가 사용 가능해졌을 때")]),t._v(" "),s("li",[t._v("예전 레플리카세트가 모두 종료되었을 때")])]),t._v(" "),s("h4",{attrs:{id:"실패-fail"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#실패-fail"}},[t._v("#")]),t._v(" 실패(Fail)")]),t._v(" "),s("ul",[s("li",[t._v("쿼터 부족")]),t._v(" "),s("li",[t._v("readinessProbe 진단 실패")]),t._v(" "),s("li",[t._v("컨테이너 이미지 가져오기 에러")]),t._v(" "),s("li",[t._v("권한 부족")]),t._v(" "),s("li",[t._v("제한 범위 초과")]),t._v(" "),s("li",[t._v("앱 실행 조건을 잘못 지정")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl decribe deploy nginx-deployment\nConditions:\n\tType\t\t\t\tStatus\t\tReason\n\t----\t\t\t\t------\t\t------\n\tAvailable   True\t    MinimunReplicasAvailable\n\tProgressing\tFalse \t  ProgressDeadlineExceeded\n")])])]),s("br"),t._v(" "),s("h2",{attrs:{id:"데몬세트"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#데몬세트"}},[t._v("#")]),t._v(" 데몬세트")]),t._v(" "),s("ul",[s("li",[t._v("데몬세트는 클러스터 전체 노드에 특정 파드를 실행할 때 사용하는 컨트롤러")]),t._v(" "),s("li",[t._v("클러스터 안에 새롭게 노드가 추가되었을 때 데몬세트가 자동으로 해당 노드에 파드 실행")]),t._v(" "),s("li",[t._v("데몬세트트 보통 로그 수집기를 실행하거나 노드를 모니터링하는 모니터링용 데몬 등 클러스터 전체에 항상 실행시켜두어야 하는 파드에 사용")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" apps/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" DaemonSet\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fluentd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("elasticsearch\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kube"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("system "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 관리용 파드나 설정에 해당하므로 kube-system 네임스페이스 설정")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 오브젝트를 식별하는 레이블")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("k8s-app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fluentd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("logging\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchLabels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fluentd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("elasticsearch\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("updateStrategy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" RollingUpdate "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Ondelete와 RollingUpdate 두 가지 값중 하나 선택")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fluentd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("elasticsearch\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fluentd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("elasticsearch\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fluent/fluentd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("kubernetes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("daemonset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("elasticsearch\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" testenv\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" value\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("resources")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("limits")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("memory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 200Mi\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("requests")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cpu")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 100m\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("memory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 200Mi\n")])])]),s("br"),t._v(" "),s("h2",{attrs:{id:"스테이트풀세트"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#스테이트풀세트"}},[t._v("#")]),t._v(" 스테이트풀세트")]),t._v(" "),s("ul",[s("li",[t._v("스테이트풀세트는 상태가 있는 파드들을 관리하는 컨트롤러")]),t._v(" "),s("li",[t._v("볼륨을 사용해서 특정 데이터를 저장한 후 파드를 재시작했을 때 해당 데이터를 유지")]),t._v(" "),s("li",[t._v("여러 개의 파드 사이에 순서를 지정해서 실행되도록 할 수도 있음")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 스테이트풀세트에서 사용할 서비스 설정 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Service\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterIP")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" None\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" apps/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" StatefulSet\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 스테이트풀세트의 이름")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchLabels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("statefulset\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("serviceName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nginx-statefulset-service"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replicas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("statefulset\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("terminationGracePeriodSeconds")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 그레이스풀의 대기 시간 설정")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("statefulset\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web%\n")])])]),s("ul",[s("li",[s("p",[s("strong",[t._v("그레이스풀(gracefull):")]),t._v(" 실행 중인 프로세스를 종료할 때 바로 종료하는 것이 아니라 하던 작업을 마무리하고 정상적으로 종료하는 것을 의미")])]),t._v(" "),s("li",[s("p",[s("code",[t._v(".spec.podManagement")]),t._v(" Policy 필드를 이용해 순서를 없앨 수도 있음")])])]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"잡-job"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#잡-job"}},[t._v("#")]),t._v(" 잡(Job)")]),t._v(" "),s("ul",[s("li",[t._v("잡은 실행된 후 종료해야 하는 성격의 작업을 실행시킬 때 사용하는 컨트롤러")]),t._v(" "),s("li",[t._v("특정 개수만큼의 파드를 정상적으로 실행 종료함을 보장함")]),t._v(" "),s("li",[t._v("파드 실행 실패, 하드웨어 장애 발생, 노드 재시작 등 문제가 발생하면 다시 파드 실행")]),t._v(" "),s("li",[t._v("잡 하나가 파드 여러 개 실행 가능")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" batch/v1 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 잡이 사용하는 버전")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Job\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pi\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pi\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" perl\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"perl"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-Mbignum=bpi"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-wle"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"print bpi(2000)"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 원주율 계산 펄(perl) 명령")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restartPolicy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Never "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 항상 성공으로 끝나도록 설정(OnFailure: 비정상적으로 실행 종료된 파드 관리)")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("backoffLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 최대 몇 번까지 재시작할 것인지 설정")]),t._v("\n")])])]),s("h3",{attrs:{id:"잡-병렬설-관리"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#잡-병렬설-관리"}},[t._v("#")]),t._v(" 잡 병렬설 관리")]),t._v(" "),s("ul",[s("li",[t._v("잡 하나가 몇 개의 파드를 동시에 실행할지를 '잡 병렬성'이라고 함")])]),t._v(" "),s("h3",{attrs:{id:"잡의-종류"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#잡의-종류"}},[t._v("#")]),t._v(" 잡의 종류")]),t._v(" "),s("h4",{attrs:{id:"단일-잡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#단일-잡"}},[t._v("#")]),t._v(" 단일 잡")]),t._v(" "),s("ul",[s("li",[t._v("파드 하나만 실행")]),t._v(" "),s("li",[t._v("파드가 정상적으로 실행 종료(파드 생명 주기가 Succeeded)되면 잡 실행을 완료")]),t._v(" "),s("li",[s("code",[t._v(".spec.completions")]),t._v("와 "),s("code",[t._v(".spec.parallelism")]),t._v(" 필드를 설정하지 않음")])]),t._v(" "),s("h4",{attrs:{id:"완료-개수가-있는-병렬-잡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#완료-개수가-있는-병렬-잡"}},[t._v("#")]),t._v(" 완료 개수가 있는 병렬 잡")]),t._v(" "),s("ul",[s("li",[s("code",[t._v(".spec.completions")]),t._v(" 필드 값으로 양수를 설정. 필드 값이 1이면 정상적으로 실행 종료된 파드가 1개만 생겨도 잡이 완료")]),t._v(" "),s("li",[s("code",[t._v(".spec.parallelism")]),t._v(" 필드는 설정하지 않거나 기본값인 1로 설정")])]),t._v(" "),s("h4",{attrs:{id:"워크-큐가-있는-병렬-잡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#워크-큐가-있는-병렬-잡"}},[t._v("#")]),t._v(" 워크 큐가 있는 병렬 잡")]),t._v(" "),s("ul",[s("li",[s("code",[t._v(".spec.completions")]),t._v(" 필드는 설정하지 않고, "),s("code",[t._v(".spec.parallelism")]),t._v(" 필드는 양수로 설정")]),t._v(" "),s("li",[t._v("파드 각각은 정상적으로 실행 종료됐는지를 독립적으로 결정 가능")]),t._v(" "),s("li",[t._v("대기열에 있는 작업들이 모두 동시에 실행될 수 있음")]),t._v(" "),s("li",[t._v("파드 하나라도 정상적으로 실행 종료되면 새로운 파드가 실행되지 않음")]),t._v(" "),s("li",[t._v("최소한 파드 1개가 정상적으로 종료된 후 모든 파드가 실행 종료되면, 잡이 정상적으로 종료됨")]),t._v(" "),s("li",[t._v("파드 1개가 정상적으로 실행 종료되면 다른 파드는 더 이상 동작하지 않거나 어떤 작업 처리 결과를 내지 않음")])]),t._v(" "),s("h3",{attrs:{id:"잡-패턴"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#잡-패턴"}},[t._v("#")]),t._v(" 잡 패턴")]),t._v(" "),s("ul",[s("li",[t._v("잡에서 파드를 병렬로 실행했을 때 파드 각각이 서로 통신하면서 동작하지 않음")])]),t._v(" "),s("h4",{attrs:{id:"잡의-일반적인-사용-패턴"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#잡의-일반적인-사용-패턴"}},[t._v("#")]),t._v(" 잡의 일반적인 사용 패턴")]),t._v(" "),s("ul",[s("li",[t._v("잡을 생성하는 오버헤드가 크기 때문에 작업마다 잡을 하나씩 생성해 사용하는 것보다는 모든 작업을 관리하는 잡 하나를 사용하는 것이 좋음")]),t._v(" "),s("li",[t._v("작업 개수만큼의 파드를 생성하는 것보다 파드 하나가 여러 개의 작업을 처리하는 것이 좋음")]),t._v(" "),s("li",[t._v("워크 큐를 사용한다면 카프카나 RabbitMQ 같은 큐 서비스로 워크 큐를 구현하도록 깆ㄴ 프로그램이나 컨테이너를 수정해야함")])]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"크론잡-cronjob"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#크론잡-cronjob"}},[t._v("#")]),t._v(" 크론잡(CronJob)")]),t._v(" "),s("ul",[s("li",[t._v("크론잡은 잡을 시간 기준으로 관리하도록 생성")]),t._v(" "),s("li",[t._v("지정한 시간에 한번만 잡을 실행하거나 지정한 시간동안 주기적으로 잡을 반복 실행 가능")])]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"referenses"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#referenses"}},[t._v("#")]),t._v(" Referenses")]),t._v(" "),s("ul",[s("li",[t._v("쿠버네티스 입문 - 90가지 예제로 배우는 컨테이너 관리 자동화 표준 / 동양북스")])])],1)}),[],!1,null,null,null);a.default=n.exports}}]);